# Assistant UI Refactoring Plan

This document outlines the plan to refactor the assistant UI using `assistant-ui`, `@mastra/client-js`, and `shadcn/ui`.

## 1. Research Summary

*   **`assistant-ui`**: A React library for building AI chat interfaces. It provides the core components and primitives for creating a chat experience, such as `Thread`, `Message`, and `Composer`. It is built on top of `shadcn/ui` and Tailwind CSS.
*   **`@mastra/client-js`**: A JavaScript client for interacting with a Mastra backend. It handles the business logic of the chat application, including managing agents, conversation history (memory), and executing tools. The frontend will use this client to communicate with the Mastra server.
*   **`shadcn/ui`**: A collection of reusable UI components for React. Since `assistant-ui` is built on it, we will use `shadcn/ui` for the base styling and for any additional UI components not provided by `assistant-ui`. The initial query about `ag-ui` was confirmed to be a typo for `shadcn/ui`.

The integration strategy will be to use `assistant-ui` for the frontend chat components, `@mastra/client-js` to connect to the Mastra backend for conversation logic, and `shadcn/ui` for the base component library and styling.

## 2. Packages to Install

The following npm packages will need to be installed:

```bash
yarn add @assistant-ui/react @mastra/client-js @radix-ui/react-tooltip @radix-ui/react-slot lucide-react remark-gfm class-variance-authority clsx
yarn add -D tailwindcss postcss autoprefixer
```

We will also need to initialize `shadcn/ui`:

```bash
npx shadcn-ui@latest init
```

## 3. New Component Structure

The new component structure will be organized under [`src/components/assistant-ui/`](src/components/assistant-ui/).

*   `assistant-chat.tsx`: The main chat component that will bring together the thread, messages, and composer. It will use `@mastra/client-js` to manage the conversation state.
*   `thread.tsx`: A wrapper around the `Thread` primitive from `assistant-ui`, responsible for displaying the conversation history.
*   `message.tsx`: A component to render individual messages (from both the user and the assistant), using the `Message` primitive.
*   `composer.tsx`: The input area for the user, built using the `Composer` primitive.

## 4. Conversation Logic with `mastra-client`

`@mastra/client-js` will be used in a custom hook, `useMastraChat`, to handle all interactions with the Mastra backend. This hook will encapsulate the following logic:

*   Initializing the `MastraClient`.
*   Creating and managing conversation threads using the Memory API.
*   Sending user messages to the agent and receiving responses.
*   Streaming responses from the agent for real-time updates.
*   Handling errors from the API.

This hook will be used by the `assistant-chat.tsx` component to drive the chat interface.

## 5. Core UI with `assistant-ui`

The core UI of the chat interface will be built using the primitives provided by `@assistant-ui/react`.

*   `ThreadPrimitive.Root`: The root component for the chat thread.
*   `ThreadPrimitive.Messages`: To render the list of messages.
*   `ComposerPrimitive.Root`: For the message input composer.

These primitives will be styled using `shadcn/ui` and Tailwind CSS to match the application's design system.

## 6. Styling with `shadcn/ui`

`shadcn/ui` will be used for:

*   **Base Components**: Buttons, inputs, tooltips, and other base components will be sourced from `shadcn/ui`. `assistant-ui` already uses these, so the integration will be seamless.
*   **Styling**: We will use Tailwind CSS utility classes and the `tailwind.config.js` file generated by `shadcn/ui` to ensure a consistent look and feel.
*   **Custom Components**: Any custom UI components needed for the assistant interface will be built using `shadcn/ui`'s patterns.

## 7. File Modification and Creation Plan

*   **Create**:
    *   [`docs/assistant-ui-refactor-plan.md`](docs/assistant-ui-refactor-plan.md) (this file)
    *   `src/components/assistant-ui/assistant-chat.tsx`
    *   `src/components/assistant-ui/thread.tsx`
    *   `src/components/assistant-ui/message.tsx`
    *   `src/components/assistant-ui/composer.tsx`
    *   `src/hooks/use-mastra-chat.ts`

*   **Modify**:
    *   `src/components/apps/assistant-app.tsx`: This file will be updated to remove the old chat implementation and render the new `AssistantChat` component.
    *   `package.json`: To add the new dependencies.
    *   `tailwind.config.js`: To integrate `shadcn/ui`'s theme.
    *   `postcss.config.js`, `components.json`: To support `shadcn/ui`.

This plan provides a clear path to refactoring the assistant UI with modern, robust libraries.